{% extends 'plein/site_layout.dtl' %}
{% comment %}
                Copyright (c) 2019-2022 Ramon van der Winkel.
                All rights reserved.
                Licensed under BSD-3-Clause-Clear. See LICENSE file for details.
{% endcomment %}
{% load static %}
{% load overig_filters %}   <!-- wbr_email filter -->

{% block title %}Profiel{% endblock %}

{% block pagina %}

    <!-- banner -->
    <div class="row center">
        <div class="col s12">
            <h3 class="nhb-rood-text">Mijn pagina</h3>
            <p>Op deze pagina verzamelen we informatie die voor jou interessant is.</p>
        </div>
    </div>

    <!-- meteen even doen -->
    {% if moet_bogen_kiezen %}

        <!-- witruimte -->
        <div class="row center">
            <div class="col s12">
                <h4>Meteen even doen</h4>
                <p>We willen je vragen om persoonlijke keuzes door te geven.</p>
            </div>
        </div>

        <!-- blauwe balk met kaartjes -->
        <div class="row-nhb-blauw" style="padding-top:50px; padding-bottom:50px">
            <div class="col s12">
                <!-- voorkeuren -->
                {% url 'Sporter:voorkeuren' as card_url %}
                {% include 'plein/card.dtl' with title="Voorkeuren" text="Stel in met welke boog je schiet." icon="tune" url=card_url %}
            </div>
        </div>

    {% endif %}     <!-- moet boog kiezen -->


    {% if toon_bondscompetities %}

        <!-- witruimte -->
        <div class="row center">
            <div class="col s12">
                <h4>Bonds<wbr>competities</h4>
            </div>
        </div>

        <!-- blauwe balk met kaartjes -->
        <div class="row-nhb-blauw">
            <div class="col s12">

                <table class="white">
                    {% if competities %}
                        <tr>
                            <td colspan="3" class="center"><h6>De volgende competities worden georganiseerd</h6></td>
                        </tr>

                        <tr>
                            <th>Competitie</th>
                            <th>Fase</th>
                            <th>Status</th>
                        </tr>

                        {% for comp in competities %}
                            <tr>
                                <td>{{ comp.beschrijving }}</td>
                                <td>{{ comp.fase_str }}</td>
                                <td>{{ comp.inschrijven }}</td>
                            </tr>
                        {% endfor %}
                    {% else %}
                        <tr>
                            <td colspan="3" class="center">Er worden op dit moment geen competities georganiseerd.</td>
                        </tr>
                    {% endif %}
                </table>
            </div>

            <div class="col s12">
                <p>&nbsp;</p>
            </div>

            <div class="col s12">
                <table class="white">

                    {% if regiocompetities %}
                        <tr>
                            <td colspan="3" class="center">
                                <h6>De volgende competities passen bij de bogen waar jij mee schiet{% if gebruik_knoppen %}. Doe je mee?{% endif %}</h6>
                            </td>
                        </tr>

                        <tr>
                            <th>Competitie</th>
                            <th>Wedstrijdboog</th>
                            <th>Status</th>
                            <th><!-- kolom voor knopje --></th>
                        </tr>

                        {% for deelcomp in regiocompetities %}

                            <tr>
                                <td>{{ deelcomp.competitie.beschrijving }}</td>
                                <td>{{ deelcomp.boog_beschrijving }}</td>
                                <td>
                                    {% if deelcomp.boog_niet_meer %}
                                        {% if deelcomp.is_ingeschreven %}
                                            {% if deelcomp.url_afmelden %}
                                                <span class="red-text">Je bent nog ingeschreven</span>
                                            {% else %}
                                                <span>Je bent ingeschreven (afmelden kan niet meer)</span>
                                            {% endif %}
                                        {% endif %}
                                    {% else %}
                                        {% if deelcomp.is_ingeschreven %}
                                            <span class="green-text">Je bent ingeschreven</span>
                                        {% else %}
                                            <span>Je bent niet ingeschreven</span>
                                        {% endif %}
                                    {% endif %}
                                </td>
                                <td>
                                    {% if deelcomp.url_schietmomenten %}
                                        <a class="btn-nhb-blauw" href="{{ deelcomp.url_schietmomenten }}">Aanpassen</a>
                                        <span>&nbsp;&nbsp;</span>
                                    {% endif %}
                                    {% if deelcomp.url_aanmelden %}
                                        <a class="btn-nhb-rood" href="{{ deelcomp.url_aanmelden }}">Aanmelden</a>
                                    {% else %}
                                        {% if deelcomp.url_afmelden %}
                                            <form method="post" action="{{ deelcomp.url_afmelden }}" style="display:inline">
                                                {% csrf_token %}
                                                <input class="btn-nhb-blauw" type="submit" value="Uitschrijven" style="display:inline">
                                            </form>
                                        {% elif deelcomp.competitie.fase < 'B' %}
                                            <span>Inschrijven kan nog niet</span>
                                        {% endif %}
                                    {% endif %}
                                </td>
                            </tr>

                        {% endfor %}

                    {% endif %}     <!-- regiocompetities -->

                    {% if gebruik_knoppen %}
                        <tr>
                            <td colspan="3">Gebruik de knoppen om je aan te melden of voorkeuren aan te passen.</td>
                        </tr>
                    {% endif %}
                </table>
            </div>

            <div class="col s12">
                <p>&nbsp;</p>
            </div>

            <div class="col s12">
                <!-- algemene informatie over de competities -->
                {% url 'Competitie:info-competitie' as card_url %}
                {% include 'plein/card.dtl' with title="Informatie" text="Algemene informatie over de competities." icon="info" url=card_url %}
            </div>
        </div>

    {% endif %}         <!-- toon_bondscompetities -->


    <!-- witruimte -->
    <div class="row center">
        <div class="col s12">
            <h4>Bondspas</h4>
            <p>De digitale bondspas is je bewijs van lidmaatschap. Op wedstrijden kan gevraagd worden om deze te tonen.</p>
        </div>
    </div>

    <!-- blauwe balk met kaartjes -->
    <div class="row-nhb-blauw">
        <div class="col s12">
            <!-- bondspas -->
            {% include 'plein/card.dtl' with title="Bondspas" text="Bekijk je digitale bondspas." icon="card_membership" url=url_bondspas %}
        </div>
    </div>


    <!-- witruimte -->
    <div class="row center">
        <div class="col s12">
            <h4>Je leeftijdsklasse</h4>
            <p>Op wedstrijden en in de bondscompetities word je ingedeeld in een wedstrijdklasse aan de hand van je leeftijd.</p>
        </div>
    </div>

    <!-- blauwe balk met kaartjes -->
    <div class="row-nhb-blauw">
        <div class="col s12">
            {% url 'Sporter:leeftijdsklassen' as card_url %}
            {% include 'plein/card.dtl' with title="Leeftijdsklassen" text="Bekijk in welke leeftijdsklassen jij uit moet komen." icon="grade" url=card_url %}
        </div>
    </div>


    <!-- witruimte -->
    <div class="row center">
        <div class="col s12">
            <h4>Voorkeuren</h4>
        </div>
    </div>

    <!-- blauwe balk met kaartjes -->
    <div class="row-nhb-blauw">
        <div class="col s12">
            <!-- voorkeuren -->
            {% url 'Sporter:voorkeuren' as card_url %}
            {% include 'plein/card.dtl' with title="Voorkeuren" text="Pas je persoonlijke voorkeuren aan." icon="tune" url=card_url %}

            <!-- wachtwoord wijzigen -->
            {% url 'Account:nieuw-wachtwoord' as card_url %}
            {% include 'plein/card.dtl' with title="Wachtwoord" text="Wijzig het wachtwoord wat nodig is om in te loggen." icon="https" url=card_url %}
        </div>
    </div>


    {% if records %}

        <!-- witruimte -->
        <div class="row center">
            <div class="col s12">
                <h4>Records!</h4>
                <p>De volgende records staan geregistreerd op jouw naam.</p>
            </div>
        </div>

        <!-- blauwe balk met informatie -->
        <div class="row-nhb-blauw">
            <div class="col s12">
                <table class="white">
                    <thead>
                        <tr>
                            <th>Datum</th>
                            <th>Soort record</th>
                            <th>Boog type</th>
                            <th>Score</th>
                            {% if show_loc %}
                                <th>Plaats</th>
                            {% endif %}
                            <th><!-- kolom voor knop --></th>
                        </tr>
                    </thead>

                    {% for obj in records %}
                        <tr>
                            <td>{{ obj.datum }}</td>
                            <td>{{ obj.soort_record }}</td>
                            <td>{{ obj.boog_str }}</td>
                            <td>{{ obj.score_str }}</td>
                            {% if show_loc %}
                                <td>{{ obj.loc_str }}</td>
                            {% endif %}
                            <td><a class="btn-nhb-rood" href="{{ obj.url }}">Details</a></td>
                        </tr>
                    {% endfor %}
                </table>
            </div>
        </div>

    {% endif %}


    {% if speelsterktes %}

        <!-- witruimte -->
        <div class="row center">
            <div class="col s12">
                <h4>Prestatiespelden</h4>
                <p>De volgende spelden, veren of schilden zijn door jou behaald:</p>
            </div>
        </div>

        <!-- blauwe balk met informatie -->
        <div class="row-nhb-blauw">
            <div class="col s12">

                <!-- details: https://worldarchery.sport/rulebook/article/17#article-723
                  en: https://worldarchery.sport/sport/education/badge-awards -->

                <table class="white">
                    <thead>
                        <tr>
                            <th>Discipline</th>
                            <th>Onder<wbr>scheiding</th>
                            <th>Categorie</th>
                            <th>Datum</th>
                        </tr>
                    </thead>

                    {% for obj in speelsterktes %}
                        <tr>
                            <td>{{ obj.discipline }}</td>
                            <td>{{ obj.beschrijving }}</td>
                            <td>{{ obj.category }}</td>
                            <td>{{ obj.datum }}</td>
                        </tr>
                    {% endfor %}

                    <tr>
                        <td colspan="4" class="center">
                            <span>Kijk op <code>www.handboogsport.nl</code> onder Procedures hoe je een prestatiespeld aan kan vragen:</span><br><br>
                            <a class="btn-nhb-rood" href="https://www.handboogsport.nl/de-nhb/#procedures" target="_blank" rel="noopener noreferrer">
                                <i class="material-icons-round left">open_in_new</i>Link</a>
                        </td>
                    </tr>
                </table>
            </div>
        </div>

    {% endif %}     <!-- speelsterktes -->


    {% if histcomp %}

        <!-- witruimte -->
        <div class="row center">
            <div class="col s12">
                <h4>Jouw bondscompetitie scores</h4>
            </div>
        </div>

        <!-- blauwe balk met informatie -->
        <div class="row-nhb-blauw">

            {% if regiocomp_scores %}
                <div class="col s12">
                    <table class="white">
                        <tr>
                            <td colspan="5" class="center">
                                <h6>Dit zijn jouw scores van het huidige seizoen</h6>
                            </td>
                        </tr>

                        <tr>
                            <th>Competitie</th>
                            <th>Seizoen</th>
                            <th>Boog</th>
                            <th>Scores</th>
                            <th class="center">Gemiddelde pijl</th>
                        </tr>

                        <tr style="visibility: collapse">
                            <td>18m Indoor</td>
                            <td>8888/8888</td>
                            <td>Instinctive Bow</td>
                            <td>888, 888, 888, 888, 888, 888, 888</td>
                            <td class="center">8,888</td>
                        </tr>

                        {% for deelnemer in regiocomp_scores %}
                            <tr>
                                <td>{{ deelnemer.competitie_str }}</td>
                                <td>{{ deelnemer.seizoen_str }}</td>
                                <td>{{ deelnemer.boog_str }}</td>
                                <td>{{ deelnemer.scores_str }}</td>
                                <td class="center smal">{{ deelnemer.gemiddelde }}</td>
                            </tr>
                        {% endfor %}
                    </table>
                </div>
            {% endif %}

            <div class="col s12">
                <p>&nbsp;</p>
            </div>

            <div class="col s12">
                <table class="white">
                    <tr>
                        <td colspan="5" class="center">
                            <h6>Dit zijn jouw scores van voorgaande seizoenen</h6>
                        </td>
                    </tr>

                    <tr>
                        <th>Competitie</th>
                        <th>Seizoen</th>
                        <th>Boog</th>
                        <th>Scores</th>
                        <th class="center">Gemiddelde pijl</th>
                    </tr>

                    <tr style="visibility: collapse">
                        <td>18m Indoor</td>
                        <td>8888/8888</td>
                        <td>Instinctive Bow</td>
                        <td>888, 888, 888, 888, 888, 888, 888</td>
                        <td class="center">8,888</td>
                    </tr>

                    {% for obj in histcomp %}
                        <tr>
                            <td>{{ obj.competitie_str }}</td>
                            <td>{{ obj.seizoen_str }}</td>
                            <td>{{ obj.boog_str }}</td>
                            <td>{{ obj.scores_str }}</td>
                            <td class="center">{{ obj.gemiddelde }}</td>
                        </tr>
                    {% endfor %}

                    <tr>
                        <td colspan="5">De gemiddelde pijl is berekend over de beste 6 scores.</td>
                    </tr>
                </table>
            </div>
        </div>

    {% endif %}     <!-- histcomps -->


    {% if heeft_ags %}

        <!-- witruimte -->
        <div class="row center">
            <div class="col s12">
                <h4>Jouw gemiddelden</h4>
                <p>Deze bepalen in welke wedstrijdklasse je begint in de bondscompetities.</p>
            </div>
        </div>

        <!-- blauwe balk met informatie -->
        <div class="row-nhb-blauw">
            <div class="col s12">

                <table class="white">
                    <thead>
                        <tr>
                            <th>Boog</th>
                            <th>Afstand</th>
                            <th class="center">Gemiddelde</th>
                            <th>Vast<wbr>gesteld op</th>
                            <th>Bron</th>
                        </tr>
                    </thead>

                    {% for sporterboog in gemiddelden %}
                        {% for ag in sporterboog.ags %}
                            <tr>
                                <td>{{ sporterboog.boogtype.beschrijving }}</td>
                                <td>{{ ag.afstand_meter }} meter</td>
                                <td class="center">{{ ag.ag|floatformat:3 }}</td>
                                <td>{{ ag.scorehist.when|date:"j F Y" }}</td>
                                <td>{{ ag.scorehist.notitie }}</td>
                            </tr>
                        {% endfor %}
                    {% endfor %}
                </table>
            </div>
        </div>

    {% endif %}     <!-- heeft_ags -->


    <!-- witruimte -->
    <div class="row center">
        <div class="col s12">
            <h4>Basics</h4>
            <p>Deze informatie is over jou bekend</p>
        </div>
    </div>

    <!-- blauwe balk met informatie -->
    <div class="row-nhb-blauw">
        <div class="col s12 m10 offset-m1 l8 offset-l2">
            <table class="white">
                <tr>
                    <th>Jouw bondsnummer</th>
                    <td>{{ sporter.lid_nr }}</td>
                </tr>
                <tr>
                    <th>Lid sinds</th>
                    <td>{{ sporter.sinds_datum }}</td>
                </tr>
                <tr>
                    <th>Lid bij vereniging</th>
                    <td>[{{ sporter.bij_vereniging.ver_nr }}] {{ sporter.bij_vereniging.naam }}</td>
                </tr>
                <tr>
                    <th>In plaats</th>
                    <td>{{ sporter.bij_vereniging.plaats }}</td>
                </tr>
                <tr>
                    <th>In NHB regio</th>
                    <td>{{ sporter.bij_vereniging.regio }}</td>
                </tr>
                <tr>
                    <th>In NHB rayon</th>
                    <td>{{ sporter.bij_vereniging.regio.rayon }}</td>
                </tr>
                {% if sporter.para_classificatie %}
                    <tr>
                        <th>Para classificatie</th>
                        <td>{{ sporter.para_classificatie }}</td>
                    </tr>
                {% endif %}
            </table>
        </div>
    </div>

    <!-- witruimte -->
    <div class="row center">
        <div class="col s12">
            <h4>Hulp nodig?</h4>
            <p>Deze personen kunnen jou helpen</p>
        </div>
    </div>

    <!-- blauwe balk met informatie -->
    <div class="row-nhb-blauw">
        <div class="col s12">
            <table class="white">
                <thead>
                    <tr>
                        <th>Functie</th>
                        <th colspan="3">Contactgegevens</th>
                    </tr>
                </thead>

                {% if not geen_wedstrijden %}

                    <!-- RCL Indoor -->
                    <tr>
                        <td rowspan="2">RCL Indoor</td>

                        <td>{% if rcl18_namen|length > 1 %}Namen:{% else %}Naam:{% endif %}</td>

                        <td colspan="2">
                            {% for naam in rcl18_namen %}
                                {% if not forloop.first %}<br>{% endif %}
                                <span>{{ naam }}</span>
                            {% empty %}
                                <i>Onbekend</i>
                            {% endfor %}
                        </td>
                    </tr>

                    <tr>
                        <td>E-mail:</td>

                        <td>
                            {% if rcl18_email %}
                                <code>{{ rcl18_email|wbr_email }}</code>
                            {% else %}
                                <i>Onbekend</i>
                            {% endif %}
                        </td>

                        <td>
                            {% if rcl18_email %}
                                <a class="btn-nhb-rood" href="mailto:{{ rcl18_email }}">
                                    <i class="material-icons-round">mail</i></a>
                            {% endif %}
                        </td>
                    </tr>

                    <!-- RCL 25m1pijl -->
                    <tr>
                        <td rowspan="2">RCL 25m1pijl</td>

                        <td>{% if rcl25_namen|length > 1 %}Namen:{% else %}Naam:{% endif %}</td>

                        <td colspan="2">
                            {% for naam in rcl25_namen %}
                                {% if not forloop.first %}<br>{% endif %}
                                <span>{{ naam }}</span>
                            {% empty %}
                                <i>Onbekend</i>
                            {% endfor %}
                        </td>
                    </tr>

                    <tr>
                        <td>E-mail:</td>
                        <td>
                            {% if rcl25_email %}
                                <code>{{ rcl25_email|wbr_email }}</code>
                            {% else %}
                                <i>Onbekend</i>
                            {% endif %}
                        </td>

                        <td>
                            {% if rcl25_email %}
                                <a class="btn-nhb-rood" href="mailto:{{ rcl25_email }}">
                                    <i class="material-icons-round">mail</i></a>
                            {% endif %}
                        </td>
                    </tr>

                    <tr>
                        <td colspan="4">De regiocompetitieleiders (RCL) regelen alles rond de competities en kan je benaderen als er problemen zijn met de uitslagen.</td>
                    </tr>


                    <tr class="nhb-table-header">
                        <td colspan="4"></td>
                    </tr>

                    <tr>
                        <th>Functie</th>
                        <th colspan="3">Contactgegevens</th>
                    </tr>


                    <!-- HWL -->
                    <tr>
                        <td rowspan="2">Wedstrijd<wbr>leiding</td>

                        <td>{% if hwl_namen|length > 1 %}Namen:{% else %}Naam:{% endif %}</td>

                        <td colspan="2">
                            {% for naam in hwl_namen %}
                                {% if not forloop.first %}<br>{% endif %}
                                <span>{{ naam }}</span>
                            {% empty %}
                                <i>Onbekend</i>
                            {% endfor %}
                        </td>
                    </tr>

                    <tr>
                        <td>E-mail:</td>
                        <td>
                            {% if hwl_email %}
                                <code>{{ hwl_email|wbr_email }}</code>
                            {% else %}
                                <i>Onbekend</i>
                            {% endif %}
                        </td>

                        <td>
                            {% if hwl_email %}
                                <a class="btn-nhb-rood" href="mailto:{{ hwl_email }}">
                                    <i class="material-icons-round">mail</i></a>
                            {% endif %}
                        </td>
                    </tr>

                    <tr>
                        <td colspan="4">De wedstrijdleiding van jouw vereniging is er voor vragen over wedstrijden en de competitie, zoals waar je heen moet.</td>
                    </tr>

                    <tr class="nhb-table-header">
                        <td colspan="4"></td>
                    </tr>

                    <tr>
                        <th>Functie</th>
                        <th colspan="3">Contactgegevens</th>
                    </tr>

                {% endif %}

                <!-- SEC -->
                <tr>
                    <td rowspan="2">Secretaris vereniging</td>

                    <td>{% if sec_namen|length > 1 %}Namen:{% else %}Naam:{% endif %}</td>

                    <td colspan="2">
                        {% for naam in sec_namen %}
                            {% if not forloop.first %}<br>{% endif %}
                            <span>{{ naam }}</span>
                        {% empty %}
                            <i>Onbekend</i>
                        {% endfor %}
                    </td>
                </tr>

                <tr>
                    <td>E-mail:</td>
                    <td>
                        {% if sec_email %}
                            <code>{{ sec_email|wbr_email }}</code>
                        {% else %}
                            <i>Onbekend</i>
                        {% endif %}
                    </td>

                    <td>
                        {% if sec_email %}
                            <a class="btn-nhb-rood" href="mailto:{{ sec_email }}">
                                <i class="material-icons-round">mail</i></a>
                        {% endif %}
                    </td>
                </tr>

                <tr>
                    <td colspan="4">De secretaris is er voor vragen over je lidmaatschap, voor het wijziging van je e-mailadres, doorgeven van een verhuizing, etc.</td>
                </tr>


                <!-- bondsbureau -->
                <tr class="nhb-table-header">
                    <td colspan="4"></td>
                </tr>

                <tr>
                    <th>Functie</th>
                    <th colspan="3">Contactgegevens</th>
                </tr>

                <tr>
                    <td>Bondsbureau</td>
                    <td>E-mail:</td>
                    <td><code>{{ bb_email }}</code></td>
                    <td>
                        <a class="btn-nhb-rood" href="mailto:{{ bb_email }}">
                                <i class="material-icons-round">mail</i></a>
                    </td>
                </tr>

                <tr>
                    <td colspan="4">Voor alle overige vragen kan je contact opnemen met het bondsbureau van de NHB</td>
                </tr>

            </table>
        </div>
    </div>


    <!-- witruimte -->
    <div class="row center">
        <div class="col s12">
            <h4>Privacy</h4>
        </div>
    </div>

    <!-- blauwe balk met informatie -->
    <div class="row-nhb-blauw">
        <div class="col s12">
            {% url 'Plein:privacy' as card_url %}
            {% include 'plein/card.dtl' with title="Privacyverklaring" text="Lees hier om we omgaan met jouw privacy." icon="security" url=card_url %}
        </div>
    </div>

    {% include 'overig/site-feedback-sidebar.dtl' with op_pagina="sporter-profiel" %}

{% endblock %}
