<!DOCTYPE html>
{% comment %}
                Copyright (c) 2019-2022 Ramon van der Winkel.
                All rights reserved.
                Licensed under BSD-3-Clause-Clear. See LICENSE file for details.
{% endcomment %}

{% comment %}

    Dit document is de blauwdruk voor alle pagina's van de site.
    Andere template's beginnen met een 'extends' op deze template
    en kunnen de volgende block tags gebruiken om delen te vervangen:
        extraheader   uitbreiding in de head sectie
        title         pagina titel instellen
        pagina        de body van de pagina

{% endcomment %}

{% load static %}

{% autoescape on %}

<html lang="nl">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>{% block title %}{% endblock %}</title>
        <link rel="icon" href="{% static 'plein/logo_nhb_192x192.png' %}" sizes="192x192">
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com">
        <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons+Round">
        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Open+Sans&amp;display=swap">
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Ubuntu&amp;display=swap">
        <link rel="stylesheet" href="{% static 'materialize-new-52.css' %}">
        <link rel="stylesheet" href="{% static 'site_layout_min-25.css' %}"> <!-- moet nÃ¡ materialize css -->
        {% block extraheader %}{% endblock %}
    </head>

    <body class="nhb-grijs">
        <div id="container">        <!-- css manipulates this to make space for the menu -->

            <!-- main contents -->
            <div id="content">      <!-- css manipulates this -->

                <!-- button to call-up the sidenav; hidden when not needed -->
                <a id="discover-menu" href="#" data-target="slide-out" class="sidenav-trigger hide-on-large-only">
                    <i class="material-icons-round black-text" style="line-height:1.2">menu</i>
                </a>

                <!-- aandachtstrekker: uitleg hoe in het menu te komen -->
                <div class="tap-target" data-target="discover-menu" id="tap-target-voor-menu">
                    <div class="tap-target-content white-text">
                        <h5>Toegang tot het menu</h5>
                        <p>Gebruik de drie streepjes om het menu op te roepen</p>
                        <button class="btn-nhb-rood" onclick="closeTapTarget('tap-target-voor-menu')">Ik snap het</button>
                    </div>
                </div>

                <!-- screen-size indicator labels -->
                {% if toon_schermgrootte %}
                    <div style="position: fixed; left: 320px; top: 2px; font-size:10px">
                        <span class="hide-unless-small">Small</span>
                        <span class="hide-unless-medium">Medium</span>
                        <span class="hide-unless-large">Large</span>
                        <span class="hide-unless-xlarge">Extra-large</span>
                    </div>
                {% endif %}

                <!-- echt pagina komt hier, vanuit de template -->
                {% block pagina %}{% endblock %}
            </div>

            <!-- sidenav (als laatste zodat dit niet de eerste tabstop is) -->
            <div id="menu">
                <ul id="slide-out" class="sidenav sidenav-fixed">
                    {% include 'plein/menu-1-head.dtl' %}

                    <!-- vervangbaar deel van het menu -->
                    {% block menu-competities %}
                        {% include 'plein/menu-2-competities.dtl' %}
                    {% endblock %}

                    {% include 'plein/menu-3.dtl' %}

                    {% include 'plein/menu-9-tail.dtl' %}
                </ul>
            </div>

        </div>

        <script src="{% static 'materialize-new-10_min.js' %}"></script>
        <script src="{% static 'site_layout-2_min.js' %}"></script>

        <!-- framework init, after everything has been loaded and instantiated -->
        <script type="application/javascript">
            function discover_popup_delayed_open()
            {
                // in de tussentijd kan het scherm al weer groter zijn geworden
                let menu_is_hidden = window.matchMedia("(max-width: 985px)")
                if (menu_is_hidden.matches)
                {
                    let elem = document.querySelector(".tap-target")
                    M.TapTarget.getInstance(elem).open()
                }
            }

            function discover_popup_show(mq_event)
            {
                // scherm is kleiner geworden (of initieel klein), dus toon de tap target
                if (mq_event == null || mq_event.matches) {
                    // cookie zorgt ervoor dat de pop-up maar 3x tonen
                    let count = getCookieNumber("menu_discover")
                    if (count < 3)
                    {
                        document.cookie = "menu_discover=" + (count + 1) + "; path=/"
                        // toon met een kleine vertraging
                        setTimeout(discover_popup_delayed_open, 2000)
                    }
                }
            }

            function discover_popup_hide(mq_event) {
                // scherm is kleiner geworden, dus haal de tap-target uit beeld
                if (mq_event.matches)
                {
                    let elem = document.querySelector(".tap-target")
                    M.TapTarget.getInstance(elem).close()
                }
            }

            function closeTapTarget(id)
            {
                // haal het tap-target element uit beeld
                let elem = document.getElementById(id)
                let inst = M.TapTarget.getInstance(elem)
                inst.close()        // administratief
                inst.destroy()      // verwijderd visuele elementen

                // zet het cookie dat voorkomt dat de tap target weer getoond wordt
                document.cookie = "menu_discover=9; path=/"
            }

            document.addEventListener("DOMContentLoaded", function() {
                // sidenav
                let elems = document.querySelectorAll(".sidenav")
                M.Sidenav.init(elems, {})

                // accordeons
                const options = { inDuration: 100,    // default is 300
                                  outDuration: 100    // default is 300
                                }
                elems = document.querySelectorAll(".collapsible")
                M.Collapsible.init(elems, options)

                // tooltips
                elems = document.querySelectorAll(".tooltipped")
                M.Tooltip.init(elems, { enterDelay: 1000 })

                // feature discovery
                elems = document.querySelectorAll(".tap-target")
                M.TapTarget.init(elems, {})

                // rolgordijnen
                elems = document.querySelectorAll("select")
                M.FormSelect.init(elems, {})

                let count = getCookieNumber("menu_discover")
                if (count < 3)
                {
                    // -------------
                    // KEEP IN SYNC
                    // - site_layout.css: media query to show/hide labels
                    // - site_layout.dtl: javascript checks for menu visible/hidden with media query
                    // - materialize.js: cut-off point to show/hide sidebar (menu)
                    // - variables.css: media query ranges
                    // -------------

                    let menu_is_shown = window.matchMedia("(min-width: 1021px)")
                    menu_is_shown.addEventListener("change", discover_popup_hide)

                    let menu_is_hidden = window.matchMedia("(max-width: 1020px)")
                    menu_is_hidden.addEventListener("change", discover_popup_show)
                    if (menu_is_hidden.matches) {
                        // show immediately
                        discover_popup_show(null)
                    }
                }
            })

            // zoek alle tabellen met een zoekveld en trigger de oninput method
            // dit is noodzakelijk bij gebruik van de browser 'back' knop
            // anders zijn de tabellen niet meer gefiltreerd
            window.addEventListener("load", function()
            {
                //console.log("load!")
                const tables = document.getElementsByTagName("table")
                Array.from(tables).forEach(table => {
                    if (table.id !== "") {
                        const inputs = table.getElementsByTagName("input")
                        if (inputs.length >= 1) myTableFilter(inputs[0], table.id)
                    }
                })

                // evalueer de posities van de labels van de forms
                // zodat het label niet over het ingevulde input veld staat
                M.updateTextFields()
            })
        </script>

    </body>
</html>

{% endautoescape %}
