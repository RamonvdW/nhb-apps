<!DOCTYPE html>
{% comment %}
                Copyright (c) 2019-2023 Ramon van der Winkel.
                All rights reserved.
                Licensed under BSD-3-Clause-Clear. See LICENSE file for details.
{% endcomment %}

{% comment %}

    Dit document is de blauwdruk voor alle pagina's van de site.
    Andere template's beginnen met een 'extends' op deze template
    en kunnen de volgende block tags gebruiken om delen te vervangen:
        extraheader   uitbreiding in de head sectie
        title         pagina titel instellen
        pagina        de body van de pagina

{% endcomment %}

{% load static %}

{% autoescape on %}

<html lang="nl">
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <title>{% block title %}{% endblock %}</title>

        {% include 'plein/site_layout_fonts.dtl' %}

        <link rel="stylesheet" href="{% static 'css/materialize-new-141.css' %}">

        {% include 'plein/site_layout_favicons.dtl' %}

        {% block extraheader %}{% endblock %}
    </head>

    <body class="white">

        <!-- top navbar -->
        <div class="navbar-fixed">
            <nav class="sv-grijs">
                <div class="nav-wrapper">
                    <!-- logo aan de linker kant -->
                    <a href="/plein/" class="brand-logo" style="left:0; transform:none; padding-left:7px; padding-top:1px; z-index:1">
                        <img src="{% static 'plein/logo_with_text_khsn.png' %}" height="62" width="264" alt="KHSN logo">
                    </a>

                    <!-- login/quick access knop aan de rechter kant -->
                    <ul id="nav-mobile" class="right">
                        {% if menu_toon_mandje %}
                            <li>
                                <!-- position:relative + z-index=2: knop boven op het logo -->
                                <a href="{% url 'Bestel:toon-inhoud-mandje' %}" class="btn-sv-rood" style="position:relative; z-index:2; margin-top:14px">
                                    {% if menu_mandje_aantal %}
                                        <i class="notranslate material-icons-round left" style="line-height:36px">shopping_cart</i>
                                        <span>{{ menu_mandje_aantal }}</span>
                                    {% else %}
                                        <i class="notranslate material-icons-round" style="line-height:36px">shopping_cart</i>
                                    {% endif %}
                                </a>
                            </li>
                        {% endif %}

                        {% if menu_voornaam %}
                            <li>
                                <!-- position:relative + z-index=2: knop boven op het logo -->
                                <a href="#" class="btn-sv-rood dropdown-trigger" data-target="navbar-dropdown" style="position:relative; z-index:2; margin-top:14px">
                                    <span class="hide-on-small-only">{{ menu_voornaam|escape }}</span>
                                    <i class="notranslate material-icons-round right hide-on-small-only" style="line-height:36px">expand_more</i>
                                    <i class="notranslate material-icons-round       hide-on-med-and-up" style="line-height:36px">expand_more</i>
                                </a>
                            </li>
                        {% elif not verberg_login_knop %}
                            <li><a href="{% url 'Account:login' %}" class="btn-sv-rood" style="position:relative; z-index:2">Inloggen</a></li>
                        {% endif %}
                    </ul>
                </div>

                <ul id="navbar-dropdown" class="dropdown-content">

                    {% if menu_url_wissel_van_rol %}
                        <li class="divider"></li>
                        <li>
                            <a href="{{ menu_url_wissel_van_rol }}">
                                <i class="notranslate material-icons-round sv-rood-text">people_alt</i>Wissel van rol</a>
                        </li>
                    {% endif %}

                    {% if menu_url_admin_site %}
                        <li class="divider"></li>
                        <li>
                            <a href="{{ menu_url_admin_site }}" target="_blank" rel="noopener noreferrer">
                                <i class="notranslate material-icons-round sv-blauw-text">build</i>Admin site</a>
                        </li>
                    {% endif %}

                    {% if menu_url_taken %}
                        <li class="divider"></li>
                        <li>
                            <a href="{{ menu_url_taken }}">
                                <i class="notranslate material-icons-round sv-rood-text">inbox</i>Taken <span class="new badge" data-badge-caption="open">{{ menu_aantal_open_taken }}</span>
                            </a>
                        </li>
                    {% endif %}

                    {% if menu_url_profiel %}
                        <li class="divider"></li>
                        <li>
                            <a href="{{ menu_url_profiel }}">
                                <i class="notranslate material-icons-round sv-rood-text">portrait</i>Mijn pagina</a>
                        </li>
                    {% endif %}

                    {% if menu_url_uitloggen %}
                        <li class="divider"></li>
                        <li>
                            <a href="{{ menu_url_uitloggen }}">
                                <i class="notranslate material-icons-round sv-rood-text">logout</i>Uitloggen</a>
                        </li>
                    {% endif %}
                </ul>
            </nav>

            <!-- screen-size indicator labels -->
            {% if menu_toon_schermgrootte %}
                <div style="position: fixed; left: 250px; top: 2px; font-size:10px">
                    <span class="hide-unless-small">Small</span>
                    <span class="hide-unless-medium">Medium</span>
                    <span class="hide-unless-large">Large</span>
                    <span class="hide-unless-xlarge">Extra-large</span>
                </div>
            {% endif %}
        </div>

        <!-- main contents -->
        <div class="nav-content-scrollbar">   <!-- css manipulates this to reduce padding on mobile -->

            {% block broodkruimels %}
                {% if kruimels %}
                    <div style="padding:10px; display:flex">
                        <button class="broodkruimels-btn-back" onclick="history.go(-1)">
                            <!--svg xmlns="http://www.w3.org/2000/svg" viewBox="0 96 960 960" height="25" width="25"><path d="M447 875 169 597q-5-5-7-10t-2-11q0-6 2-11t7-10l279-279q8-8 20-8t21 9q9 9 9 21t-9 21L262 546h496q13 0 21.5 8.5T788 576q0 13-8.5 21.5T758 606H262l228 228q8 8 8 20t-9 21q-9 9-21 9t-21-9Z"/></svg-->
                            <i class="notranslate material-icons-round">arrow_back</i>
                        </button>

                        <!--div class="valign-wrapper" style="height:25px" -->
                        <div style="height:24px; margin-top:3px">
                            <a class="broodkruimels-link" href="{% url 'Plein:plein' %}">Plein</a>
                            {% for url, kruimel in kruimels %}
                                <span class="sv-blauw-text" style="margin-right:5px; font-weight:800">&rsaquo;</span>
                                {% if not url %}
                                    <span class="broodkruimels-nolink">{{ kruimel }}</span>
                                {% else %}
                                    <a class="broodkruimels-link" href="{{ url }}">{{ kruimel }}</a>
                                {% endif %}
                            {% endfor %}
                        </div>
                    </div>
                {% endif %}
            {% endblock %}

            <!-- echt pagina komt hier, vanuit de template -->
            <main>
                {% block pagina %}{% endblock %}
            </main>
        </div>

        <script src="{% static 'js/materialize-new-15_min.js' %}"></script>
        <script src="{% static 'js/site_layout-12_min.js' %}"></script>

        <!-- framework init, after everything has been loaded and instantiated -->
        <script type="application/javascript">
            document.addEventListener("DOMContentLoaded", function() {
                // accordeons
                const options = { inDuration: 100,    // default is 300
                                  outDuration: 100    // default is 300
                                };
                let elems;

                // console.log('history.length:', history.length)
                if (history.length < 2) {
                    // nothing to go back to
                    // typically happens when opening a manual page in a new window
                    const el = document.getElementById("id_kruimels_back");
                    // element bestaat niet als broodkruimels uitgezet zijn, zoals op het Plein zelf
                    if (el) el.style.display = "none";
                }

                elems = document.querySelectorAll(".collapsible");
                M.Collapsible.init(elems, options);

                // dropdown menu
                elems = document.querySelectorAll(".dropdown-trigger");
                M.Dropdown.init(elems, {coverTrigger: false, constrainWidth: false});

                // tooltips
                elems = document.querySelectorAll(".tooltipped");
                M.Tooltip.init(elems, { enterDelay: 1000 });

                // rolgordijnen
                elems = document.querySelectorAll("select");
                M.FormSelect.init(elems, {});

                // modals
                elems = document.querySelectorAll(".modal");
                M.Modal.init(elems, {'endingTop': '35%'});
            });

            // zoek alle tabellen met een zoekveld en trigger de oninput method
            // dit is noodzakelijk bij gebruik van de browser 'back' knop
            // anders zijn de tabellen niet meer gefiltreerd
            window.addEventListener("load", function()
            {
                // console.log("load!")

                // de fonts zijn nu helemaal ingeladen, dus we kunnen de icons tonen
                const icons = document.getElementsByClassName('material-icons-round');
                Array.from(icons).forEach(icon => {
                    icon.style.display = 'inline-block'
                });

                // zoek alle tabellen met een zoekveld en trigger de oninput method
                // dit is noodzakelijk bij gebruik van de browser 'back' knop
                // anders zijn de tabellen niet meer gefiltreerd
                const tables = document.getElementsByTagName("table");
                Array.from(tables).forEach(table => {
                    if (table.id !== "") {
                        const inputs = table.getElementsByTagName("input");
                        if (inputs.length >= 1) myTableFilter(inputs[0], table.id);
                    }
                });

                // evalueer de posities van de labels van de forms
                // zodat het label niet over het ingevulde input veld staat
                M.updateTextFields();
            });

            // resize listener, om het dropdown menu automatisch te verstoppen
            window.addEventListener('resize', function() {
                const elems = document.querySelectorAll(".dropdown-trigger");
                Array.from(elems).forEach(elem => {
                    const instance = M.Dropdown.getInstance(elem);
                    if (instance.isOpen) {
                        instance.close();
                    }
                });
            });
        </script>

    </body>
</html>

{% endautoescape %}
